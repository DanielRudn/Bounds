package com.dr.bounds.maps.maptypes;

import com.DR.dLib.ui.dImage;
import com.badlogic.gdx.graphics.g2d.SpriteBatch;
import com.dr.bounds.AssetManager;
import com.dr.bounds.MainGame;
import com.dr.bounds.Player;
import com.dr.bounds.maps.obstacles.dBirdObstacle;
import com.dr.bounds.screens.GameScreen;

public class SkyMapType extends MapType { 
	
	dImage test, test2;
	
	public SkyMapType(int type, Player player, MapGenerator generator) {
		super(type, player, generator, AssetManager.getBackground("SKY_BG.png"));
		MIN_WIDTH = 64;
		typeName = "Sky";
		gen.setScoreIncrementAmount(1);
		// add 8 obstacles 
		for(int x = 0; x < 8; x++)
		{
			obstacles.add(new dBirdObstacle(0,0, AssetManager.getTexture("birdObstacle.png"), player));
			obstacles.get(x).setRegenerate(false);
		}
		test = new dImage(0,0,AssetManager.getTexture("card"));
		test.setColor(27f/256f, 188f/256f, 155f/256f, 1f);
		test.setDimensions(1024, 1024);
		test.setOriginCenter();
		test.getSprite().setRotation(45);
		test.setPos(MainGame.camera.position.x,MainGame.camera.position.y);
		
		test2 = new dImage(0,0,AssetManager.getTexture("card"));
		test2.setColor(27f/256f, 188f/256f, 155f/256f, 1f);
		test2.setDimensions(512,512);
		test2.setOriginCenter();
		test2.getSprite().setRotation(45);
		test2.setPos(MainGame.camera.position.x - 128f,MainGame.camera.position.y);
	}
	
	@Override
	public void update(float delta)
	{
		super.update(delta);
		test.setY(test.getY() - GameScreen.CAMERA_SPEED * .75f * delta);
		test2.setY(test2.getY() - GameScreen.CAMERA_SPEED * .75f * delta);
	}
	
	@Override
	public void render(SpriteBatch batch)
	{
		super.render(batch);
		test.render(batch);
		test2.render(batch);
	}
	
	@Override
	protected void generateBlock(int index)
	{
		// get direction, 0 = east, 1 = west
		int direction = MapGenerator.rng.nextInt(2);
		if(direction == 0)
		{
			((dBirdObstacle)obstacles.get(index)).setDirection(true);
			obstacles.get(index).setX(-obstacles.get(index).getWidth());
		}
		else if(direction == 1)
		{
			((dBirdObstacle)obstacles.get(index)).setDirection(false);
			obstacles.get(index).setX(MainGame.VIRTUAL_WIDTH + obstacles.get(index).getWidth());
		}
		int dimensions = MIN_WIDTH + MapGenerator.rng.nextInt(64); // TODO: change maybe? put in a final variable
		obstacles.get(index).setDimensions((float)dimensions*1.25f, dimensions);
		obstacles.get(index).setY(obstacles.get(getPreviousIndex(index)).getY() - MIN_DISTANCE - MapGenerator.rng.nextInt(MAX_DISTANCE));
	}
}
